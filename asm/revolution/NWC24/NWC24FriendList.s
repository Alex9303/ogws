.include "macros.inc"

.section .data, "wa"
.balign 0x8
lbl_803b7e60:
	.string "/shared2/wc24/nwc24fl.bin"
	.balign 4

.section .sdata, "wa"
.balign 0x8
FLFilePath:
	.incbin "baserom.dol", 0x3C7758, 0x4

.section .text, "ax"
.global NWC24iOpenFriendList
NWC24iOpenFriendList:
/* 80149F64 00144E64  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 80149F68 00144E68  7C 08 02 A6 */	mflr r0
/* 80149F6C 00144E6C  38 80 00 00 */	li r4, 0
/* 80149F70 00144E70  38 A0 03 60 */	li r5, 0x360
/* 80149F74 00144E74  90 01 00 14 */	stw r0, 0x14(r1)
/* 80149F78 00144E78  80 6D A0 90 */	lwz r3, NWC24WorkP-_SDA_BASE_(r13)
/* 80149F7C 00144E7C  38 63 24 00 */	addi r3, r3, 0x2400
/* 80149F80 00144E80  90 61 00 08 */	stw r3, 8(r1)
/* 80149F84 00144E84  4B FF 7F BD */	bl Mail_memset
/* 80149F88 00144E88  38 61 00 08 */	addi r3, r1, 8
/* 80149F8C 00144E8C  48 00 00 15 */	bl GetCachedFLHeader
/* 80149F90 00144E90  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80149F94 00144E94  7C 08 03 A6 */	mtlr r0
/* 80149F98 00144E98  38 21 00 10 */	addi r1, r1, 0x10
/* 80149F9C 00144E9C  4E 80 00 20 */	blr 

.global GetCachedFLHeader
GetCachedFLHeader:
/* 80149FA0 00144EA0  94 21 FF 50 */	stwu r1, -0xb0(r1)
/* 80149FA4 00144EA4  7C 08 02 A6 */	mflr r0
/* 80149FA8 00144EA8  90 01 00 B4 */	stw r0, 0xb4(r1)
/* 80149FAC 00144EAC  93 E1 00 AC */	stw r31, 0xac(r1)
/* 80149FB0 00144EB0  93 C1 00 A8 */	stw r30, 0xa8(r1)
/* 80149FB4 00144EB4  7C 7E 1B 78 */	mr r30, r3
/* 80149FB8 00144EB8  80 8D A0 90 */	lwz r4, NWC24WorkP-_SDA_BASE_(r13)
/* 80149FBC 00144EBC  38 84 24 00 */	addi r4, r4, 0x2400
/* 80149FC0 00144EC0  90 83 00 00 */	stw r4, 0(r3)
/* 80149FC4 00144EC4  80 64 00 00 */	lwz r3, 0(r4)
/* 80149FC8 00144EC8  3C 03 A8 9D */	addis r0, r3, 0xa89d
/* 80149FCC 00144ECC  28 00 46 6C */	cmplwi r0, 0x466c
/* 80149FD0 00144ED0  41 82 00 94 */	beq lbl_8014A064
/* 80149FD4 00144ED4  80 8D 87 58 */	lwz r4, FLFilePath-_SDA_BASE_(r13)
/* 80149FD8 00144ED8  38 61 00 08 */	addi r3, r1, 8
/* 80149FDC 00144EDC  38 A0 00 02 */	li r5, 2
/* 80149FE0 00144EE0  4B FF 8B 45 */	bl NWC24FOpen
/* 80149FE4 00144EE4  2C 03 00 00 */	cmpwi r3, 0
/* 80149FE8 00144EE8  41 82 00 08 */	beq lbl_80149FF0
/* 80149FEC 00144EEC  48 00 00 7C */	b lbl_8014A068
lbl_80149FF0:
/* 80149FF0 00144EF0  38 61 00 08 */	addi r3, r1, 8
/* 80149FF4 00144EF4  38 80 00 00 */	li r4, 0
/* 80149FF8 00144EF8  38 A0 00 00 */	li r5, 0
/* 80149FFC 00144EFC  4B FF 90 0D */	bl NWC24FSeek
/* 8014A000 00144F00  80 7E 00 00 */	lwz r3, 0(r30)
/* 8014A004 00144F04  38 A1 00 08 */	addi r5, r1, 8
/* 8014A008 00144F08  38 80 03 60 */	li r4, 0x360
/* 8014A00C 00144F0C  4B FF 91 E9 */	bl NWC24FRead
/* 8014A010 00144F10  7C 7F 1B 78 */	mr r31, r3
/* 8014A014 00144F14  38 61 00 08 */	addi r3, r1, 8
/* 8014A018 00144F18  4B FF 8E 5D */	bl NWC24FClose
/* 8014A01C 00144F1C  2C 1F 00 00 */	cmpwi r31, 0
/* 8014A020 00144F20  41 82 00 08 */	beq lbl_8014A028
/* 8014A024 00144F24  7F E3 FB 78 */	mr r3, r31
lbl_8014A028:
/* 8014A028 00144F28  2C 03 00 00 */	cmpwi r3, 0
/* 8014A02C 00144F2C  41 82 00 08 */	beq lbl_8014A034
/* 8014A030 00144F30  48 00 00 38 */	b lbl_8014A068
lbl_8014A034:
/* 8014A034 00144F34  80 9E 00 00 */	lwz r4, 0(r30)
/* 8014A038 00144F38  80 64 00 00 */	lwz r3, 0(r4)
/* 8014A03C 00144F3C  3C 03 A8 9D */	addis r0, r3, 0xa89d
/* 8014A040 00144F40  28 00 46 6C */	cmplwi r0, 0x466c
/* 8014A044 00144F44  41 82 00 0C */	beq lbl_8014A050
/* 8014A048 00144F48  38 60 FF F2 */	li r3, -14
/* 8014A04C 00144F4C  48 00 00 1C */	b lbl_8014A068
lbl_8014A050:
/* 8014A050 00144F50  80 04 00 04 */	lwz r0, 4(r4)
/* 8014A054 00144F54  28 00 00 02 */	cmplwi r0, 2
/* 8014A058 00144F58  41 82 00 0C */	beq lbl_8014A064
/* 8014A05C 00144F5C  38 60 FF E5 */	li r3, -27
/* 8014A060 00144F60  48 00 00 08 */	b lbl_8014A068
lbl_8014A064:
/* 8014A064 00144F64  38 60 00 00 */	li r3, 0
lbl_8014A068:
/* 8014A068 00144F68  80 01 00 B4 */	lwz r0, 0xb4(r1)
/* 8014A06C 00144F6C  83 E1 00 AC */	lwz r31, 0xac(r1)
/* 8014A070 00144F70  83 C1 00 A8 */	lwz r30, 0xa8(r1)
/* 8014A074 00144F74  7C 08 03 A6 */	mtlr r0
/* 8014A078 00144F78  38 21 00 B0 */	addi r1, r1, 0xb0
/* 8014A07C 00144F7C  4E 80 00 20 */	blr 
